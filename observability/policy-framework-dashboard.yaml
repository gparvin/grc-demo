kind: ConfigMap
apiVersion: v1
metadata:
  name: policy-framework-dashboard
  namespace: open-cluster-management-observability
  labels:
    grafana-custom-dashboard: "true"
data:
  policy-framework-dashboard.json: |
    {"annotations": {"list": [{"builtIn": 1, "datasource": "-- Grafana --", "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "target": {"limit": 100, "matchAny": false, "tags": [], "type": "dashboard"}, "type": "dashboard"}]}, "editable": true, "gnetId": null, "graphTooltip": 0, "id": 25, "links": [], "panels": [{"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"hideFrom": {"legend": false, "tooltip": false, "viz": false}}, "mappings": []}, "overrides": []}, "gridPos": {"h": 8, "w": 6, "x": 0, "y": 0}, "id": 14, "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "pieType": "pie", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "tooltip": {"mode": "single"}}, "pluginVersion": "8.1.3", "targets": [{"exemplar": true, "expr": "count(policy_governance_info{type=\"root\"} == 0)", "hide": false, "instant": true, "interval": "", "legendFormat": "Compliant Policies", "refId": "B"}, {"exemplar": true, "expr": "count(policy_governance_info{type=\"root\"} == 1)", "hide": false, "instant": true, "interval": "", "legendFormat": "NonCompliant Policies", "refId": "C"}], "title": "Root Policies", "type": "piechart"}, {"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"hideFrom": {"legend": false, "tooltip": false, "viz": false}}, "mappings": []}, "overrides": []}, "gridPos": {"h": 8, "w": 6, "x": 6, "y": 0}, "id": 16, "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "pieType": "pie", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "count(policy_governance_info{type=\"propagated\"} == 0)", "hide": false, "instant": false, "interval": "", "legendFormat": "Compliant Propagated", "refId": "B"}, {"exemplar": true, "expr": "count(policy_governance_info{type=\"propagated\"} == 1)", "instant": false, "interval": "", "legendFormat": "NonCompliant Propagated", "refId": "A"}], "title": "Propagated Policies", "type": "piechart"}, {"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}, "id": 8, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "kube_pod_container_status_restarts_total{container=\"config-policy-controller\"}", "instant": false, "interval": "", "legendFormat": "Config Policy Controller Restarts", "refId": "Config policy restarts"}, {"exemplar": true, "expr": "kube_pod_container_status_restarts_total{container=\"governance-policy-framework-addon\"}", "hide": false, "instant": false, "interval": "", "legendFormat": "Governance Framework Restarts", "refId": "Governance framework restarts"}], "title": "Restarting Pods", "type": "timeseries"}, {"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8}, "id": 18, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"policy-propagator\"}[15m]))", "instant": false, "interval": "", "legendFormat": "Propagator Reconciles", "refId": "A"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_errors_total{controller=\"policy-propagator\"}[15m]))", "hide": false, "interval": "", "legendFormat": "Propagator Reconcile Errors", "refId": "B"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"policy-set\"}[15m]))", "hide": false, "interval": "", "legendFormat": "PolicySet Reconciles", "refId": "C"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_errors_total{controller=\"policy-set\"}[15m]))", "hide": false, "interval": "", "legendFormat": "PolicySet Reconcile Errors", "refId": "D"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"policy-encryption-keys\"}[15m]))", "hide": false, "interval": "", "legendFormat": "Encryption Key Reconciles", "refId": "E"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_errors_total{controller=\"policy-encryption-keys\"}[15m]))", "hide": false, "interval": "", "legendFormat": "Encryption Key Reconcile Errors", "refId": "F"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"root-policy-status\"}[15m]))", "hide": false, "interval": "", "legendFormat": "Status Reconciles", "refId": "G"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_errors_total{controller=\"root-policy-status\"}[15m]))", "hide": false, "interval": "", "legendFormat": "Status Reconcile Errors", "refId": "H"}], "title": "Policy Propagator", "type": "timeseries"}, {"datasource": null, "description": "View the work queue and the queue depth", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 9, "w": 12, "x": 12, "y": 8}, "id": 2, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "avg_over_time(workqueue_depth{name=\"policy-status-sync\"}[15m])", "hide": false, "instant": false, "interval": "", "legendFormat": "Work Queue Depth", "refId": "Status Sync Queue Depth"}, {"exemplar": true, "expr": "sum(delta(controller_runtime_reconcile_total{controller=\"policy-status-sync\"}[15m]))", "hide": false, "instant": false, "interval": "", "legendFormat": "Total Reconciles", "refId": "Status Sync Reconciles"}, {"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_errors_total{controller=\"policy-status-sync\"}[15m]))", "hide": false, "instant": false, "interval": "", "legendFormat": "Failed Reconciles", "refId": "Status Sync Reconcile Errors"}], "title": "Policy Sync Health", "type": "timeseries"}, {"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16}, "id": 12, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "sum by (cluster_namespace) (avg_over_time(policy_governance_info{type=\"propagated\"}[15m]))", "instant": false, "interval": "", "legendFormat": "Deployed NonCompliant", "refId": "A"}, {"exemplar": true, "expr": "count(policy_governance_info{type=\"propagated\"})", "hide": false, "instant": false, "interval": "", "legendFormat": "Propagated Policies", "refId": "B"}, {"exemplar": true, "expr": "count(policy_governance_info{type=\"root\"})", "hide": false, "instant": false, "interval": "", "legendFormat": "Root Policies", "refId": "C"}], "title": "Policy Overview", "type": "timeseries"}, {"datasource": null, "description": "", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 17}, "id": 4, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"policy-template-sync\"}[15m]))", "instant": false, "interval": "", "legendFormat": "Reconciles", "refId": "Template Sync Reconcile Activity"}, {"exemplar": true, "expr": "sum(increase(policy_system_errors_total{service=\"governance-policy-framework-metrics\"}[15m]))", "hide": false, "instant": false, "interval": "", "legendFormat": "System Errors", "refId": "Policy Framework Errors"}, {"exemplar": true, "expr": "avg_over_time(workqueue_depth{name=\"policy-template-sync\"}[15m])", "hide": false, "instant": false, "interval": "", "legendFormat": "Workqueue Depth", "refId": "Template Sync Reconcile"}], "title": "Template Sync Health", "type": "timeseries"}, {"datasource": null, "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 25}, "id": 6, "options": {"legend": {"calcs": [], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}}, "targets": [{"exemplar": true, "expr": "sum(increase(policy_system_errors_total{service=\"config-policy-controller-metrics\"}[15m]))", "instant": false, "interval": "", "legendFormat": "System Errors", "refId": "Configuration Policy System Errors"}, {"exemplar": true, "expr": "sum(increase(kube_pod_container_status_restarts_total{container=\"config-policy-controller\"}[15m]))", "hide": false, "instant": false, "interval": "", "legendFormat": "Restarts", "refId": "Configuration Policy Restarts"}, {"exemplar": true, "expr": "sum(increase(config_policy_evaluation_total[180s]))", "hide": false, "instant": false, "interval": "", "legendFormat": "Evaluations", "refId": "Configuration Policy Evaluations"}], "title": "Configuration Policy Health", "type": "timeseries"}], "refresh": "", "schemaVersion": 30, "style": "dark", "tags": [], "templating": {"list": []}, "time": {"from": "now-12h", "to": "now"}, "timepicker": {}, "timezone": "", "title": "Policy Framework Dashboard", "version": 27}
